# Job

## 목록

- [IptimeBrowse](#IptimeBrowse)

## IptimeBrowse

- name: IptimeBrowse
- type: scheduled
- cron: 0 0/10 * * * ?
- description: 등록된 라우터 중 Iptime 라우터의 연결 사용자를 조회하고 이를 기반으로 장치의 연결 기록을 누적합니다.

## Step

### Reader

청크 사이즈와 동일한 사이즈의 페이지 단위로 사용할 Iptime 정보를 조회합니다.

### Processor

조회된 Iptime 정보를 기반으로 인증 정보를 획득합니다.

인증 정보를 통해 Iptime 라우터 연결 사용자 정보를 조회합니다.

### Writer

라우터 연결 사용자 정보를 기반으로 장치의 연결 기록을 갱신합니다.

#### 구체적 작업

1. 라우터 정보를 조회합니다.
2. 라우터 정보를 기반으로 등록된 장치 정보를 조회합니다.
3. 등록된 장치의 연결 기록을 조회합니다.
4. 라우터 연결 사용자 정보와 장치의 연결 기록을 기반으로 장치의 상태를 분류합니다.
    - 신규 연결: 라우터 연결 사용자 (O), 장치의 연결 기록(X)
    - 연결 중: 라우터 연결 사용자 (O), 장치의 연결 기록(O)
    - 연결 해제: 라우터 연결 사용자 (X), 장치의 연결 기록(O)
5. 장치의 상태를 기반으로 장치의 연결 기록을 갱신합니다.
